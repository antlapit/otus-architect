# Otus Architect

Homework Otus Architect

## API
* в каталоге **examples** есть Postman коллекция
* в коллекции есть 2 каталога: Local (для локальной разработки) и K8s (для kubernetes - для корректной работы требуется явно передавать хост arch.homework в curl или прописать его в hosts)

## Развертывание через helm
**Команда** `helm install otus-architect-release ./deployments-helm/otus-architect`

**Состав релиза**  
* развертывание postgresql из официального чарта
* развертывание сервиса
* выполнение стартовых миграций за счет job, который удаляется после релиза
  * миграции выполняются самим сервисом при наличии переменной окружения SERVICE_MODE=INIT
  * в БД создается 1 запись о пользователе с id = 1
  * докер образ для job и сервиса один
  

## Устарело
### Манифесты для k8s
* манифесты находятся в каталоге **deployments**
* запуск командой **kubectl apply -f deployments**

